const _0x5430a5=_0x2974;(function(_0x4fc72b,_0x1b045b){const _0x4285eb=_0x2974,_0x14e746=_0x4fc72b();while(!![]){try{const _0x33615b=-parseInt(_0x4285eb(0x126))/0x1+-parseInt(_0x4285eb(0xd5))/0x2*(parseInt(_0x4285eb(0xf4))/0x3)+-parseInt(_0x4285eb(0xd8))/0x4+-parseInt(_0x4285eb(0xf8))/0x5*(parseInt(_0x4285eb(0x151))/0x6)+-parseInt(_0x4285eb(0xe0))/0x7+parseInt(_0x4285eb(0xf0))/0x8+parseInt(_0x4285eb(0xea))/0x9;if(_0x33615b===_0x1b045b)break;else _0x14e746['push'](_0x14e746['shift']());}catch(_0x23947a){_0x14e746['push'](_0x14e746['shift']());}}}(_0x1a07,0x8152b));let studentData={},currentModalStudent=null,currentModalAttendanceData=null;function _0x1a07(){const _0x2e54a2=['sort','padStart','className','trim','Class:\x20','isLate','textContent','Late\x20marks\x20(this\x20month):\x20','replace','October','\x20between\x20','Absent\x20on:\x20','No\x20attendance\x20records\x20found\x20for\x20the\x20current\x20month\x20to\x20export.','Present','false','getDocs','November','</div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22\x20id=\x22attendanceNote\x22\x20style=\x22font-size:13px;color:#666;margin-top:8px;\x22></div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22\x20id=\x22attendancePercentRow\x22><strong>Attendance\x20%\x20(this\x20month):</strong>\x20<span\x20id=\x22attendancePercentValue\x22>Loading...</span></div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22><strong>Absent\x20On:</strong>\x20<span\x20id=\x22absentDatesList\x22>Loading...</span></div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22\x20id=\x22lateMarksRow\x22\x20style=\x22margin-top:10px;\x22><strong>Late\x20Marks\x20(this\x20month):</strong>\x20<span\x20id=\x22lateMarksValue\x22>Loading...</span></div>\x0a\x20\x20','join','44wrpNOl','_blank','Failed\x20to\x20fetch\x20attendance.\x20See\x20console\x20for\x20details.','3009540mhKUhT','No\x20Firestore\x20read\x20APIs\x20exposed\x20on\x20window.','originalStatus','Firestore\x20query\x20failed\x20—\x20falling\x20back\x20to\x20client-side\x20filter:','set','Late','json','8icse','6630743RwLmeq','December','setAttribute','Name','from','error','Absent\x20On','text/csv;charset=utf-8','Firestore\x20read\x20functions\x20(getDocs/query/where)\x20are\x20not\x20exposed\x20on\x20window.\x20Please\x20export\x20them\x20in\x20your\x20head\x20module\x20script.','_document','24360570EWJmDv','Absent','attendancePercent','10icse','query','\x20→\x20','6063536iXPJiO','Failed\x20to\x20fetch\x20attendance\x20for\x20student:','Name:\x20','9sym','102093MDNzhn','date','true','getDate','293665Sxskmy','href','style','appendChild','studentData.json','getMonth','Failed\x20to\x20prepare\x20CSV.\x20See\x20console\x20for\x20details.','string','\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22><strong>Name:</strong>\x20','No\x20records','toISOString','absentDays','empty','undefined','createElement','Attendance\x20%','warn','status','January','Attendance:\x20','revokeObjectURL','innerHTML','No\x20student\x20is\x20currently\x20loaded\x20to\x20share.\x20Open\x20a\x20student\x20first.','studentDetailsModal','where','presentCount','attendance_records','6icse','Class','toLowerCase','studentName\x20is\x20required','createObjectURL','forEach','Failed\x20to\x20load\x20studentData.json','getFullYear','Period:\x20','%\x20(','attendancePercentValue','August','.csv','absentCount','toString','attendance_all_students_','No\x20records\x20this\x20month','collection','docs','427916OoqxwT','June','Attendance\x20data\x20not\x20yet\x20available.\x20Please\x20wait\x20until\x20the\x20modal\x20finishes\x20loading.','indexOf','split','remove','endISO','splice','periodEndISO','Please\x20select\x20a\x20class\x20first.','May','\x20and\x20','Firestore\x20not\x20available.','fetchAttendanceForStudentThisMonth:\x20className\x20not\x20provided\x20and\x20currentClass\x20is\x20not\x20set.\x20Query\x20will\x20match\x20only\x20by\x20name.','length','9icse','totalRecords','7icse','September','body','checkAttendance\x20query\x20failed,\x20falling\x20back:','slice','toDate','isFinite','10ssc','display','CSV\x20can\x20only\x20be\x20downloaded\x20on\x20the\x20last\x20date\x20of\x20the\x20month\x20after\x2010:00\x20PM\x20local\x20time.','click','periodStartISO','❌\x20Error\x20loading\x20student\x20data:','\x0a\x0aIf\x20you\x20have\x20any\x20questions,\x20please\x20contact\x209967772240.','Loading...','round','9gen','Attendance:\x20No\x20records\x20this\x20month','</div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22><strong>Class:</strong>\x20','March','July','Scholars\x20Academy\x20Attendance\x20Report\x20for\x20','absentDaysSet','flex','add','lateCount','6NeKXKg','function','\x20present)','getElementById','Firestore\x20not\x20available.\x20Ensure\x20window.db\x20and\x20window.collection\x20are\x20exposed\x20from\x20your\x20head\x20module\x20script.','aria-hidden','absentDatesList','DOMContentLoaded','startISO','name','data','push','April'];_0x1a07=function(){return _0x2e54a2;};return _0x1a07();}async function loadStudentData(){const _0x1e00b2=_0x2974;try{const _0x2ef339=await fetch(_0x1e00b2(0xfc));if(!_0x2ef339['ok'])throw new Error(_0x1e00b2(0x119));studentData=await _0x2ef339[_0x1e00b2(0xde)]();}catch(_0x157d37){console['error'](_0x1e00b2(0x143),_0x157d37);}}function currentMonthRangeISO(){const _0x471bd7=_0x2974,_0x55f190=new Date(),_0x544b45=_0x55f190[_0x471bd7(0x11a)](),_0xcebd0e=_0x55f190['getMonth'](),_0x53e3b9=new Date(_0x544b45,_0xcebd0e,0x1),_0x28a396=new Date(_0x544b45,_0xcebd0e+0x1,0x0),_0x4ffbc3=_0x4df3c1=>String(_0x4df3c1)[_0x471bd7(0x15f)](0x2,'0'),_0x1b76ca=_0x5cdc78=>_0x5cdc78[_0x471bd7(0x11a)]()+'-'+_0x4ffbc3(_0x5cdc78[_0x471bd7(0xfd)]()+0x1)+'-'+_0x4ffbc3(_0x5cdc78[_0x471bd7(0xf7)]());return{'startISO':_0x1b76ca(_0x53e3b9),'endISO':_0x1b76ca(_0x28a396)};}async function fetchAttendanceForStudentThisMonth(_0x56ee21,_0x203e87){const _0x5bcbfc=_0x2974;if(_0x203e87=_0x203e87||(_0x5bcbfc(0x105)!=typeof currentClass?currentClass:null),!window['db']||!window[_0x5bcbfc(0x124)])throw new Error(_0x5bcbfc(0x155));if(!_0x56ee21)throw new Error(_0x5bcbfc(0x116));_0x203e87||console[_0x5bcbfc(0x108)](_0x5bcbfc(0x133));const {startISO:_0x2e9603,endISO:_0xae45bf}=currentMonthRangeISO(),_0x51484e=window['collection'](window['db'],'attendance_records'),_0x15dfb2=_0x4f7d0b=>_0x5bcbfc(0x152)==typeof _0x4f7d0b[_0x5bcbfc(0x15b)]?_0x4f7d0b[_0x5bcbfc(0x15b)]():_0x4f7d0b[_0x5bcbfc(0xe9)]||{};if(window['getDocs']&&window[_0x5bcbfc(0xee)]&&window['where'])try{const _0x1d46a4=[window[_0x5bcbfc(0x110)](_0x5bcbfc(0x15a),'==',_0x56ee21),window[_0x5bcbfc(0x110)](_0x5bcbfc(0xf5),'>=',_0x2e9603),window[_0x5bcbfc(0x110)]('date','<=',_0xae45bf)];_0x203e87&&_0x1d46a4[_0x5bcbfc(0x12d)](0x1,0x0,window[_0x5bcbfc(0x110)](_0x5bcbfc(0x160),'==',_0x203e87));const _0x52da50=window[_0x5bcbfc(0xee)](_0x51484e,..._0x1d46a4),_0x3e5419=await window[_0x5bcbfc(0xd1)](_0x52da50);let _0x332aa9=0x0,_0x29fdc6=0x0;const _0x51ca26=[];return _0x3e5419['forEach'](_0x4e5d15=>{const _0x34e24d=_0x5bcbfc,_0x59d75e=_0x15dfb2(_0x4e5d15);_0x51ca26[_0x34e24d(0x15c)]({'id':_0x4e5d15['id'],'data':_0x59d75e});const _0x533bfe=(_0x59d75e[_0x34e24d(0x109)]||'')['toString']();_0x34e24d(0xcf)===_0x533bfe?_0x332aa9++:_0x34e24d(0xeb)===_0x533bfe&&_0x29fdc6++;}),{'presentCount':_0x332aa9,'absentCount':_0x29fdc6,'totalRecords':_0x332aa9+_0x29fdc6,'docs':_0x51ca26};}catch(_0x305337){console['error'](_0x5bcbfc(0xdb),_0x305337);}if(window[_0x5bcbfc(0xd1)]){const _0x28c30d=await window[_0x5bcbfc(0xd1)](_0x51484e);let _0x155877=0x0,_0x6b21e3=0x0;const _0x4a4480=[];return _0x28c30d['forEach'](_0x79d10e=>{const _0x4b5865=_0x5bcbfc,_0xc27d0f=_0x15dfb2(_0x79d10e);if(!_0xc27d0f)return;const _0x5d0bc8=_0xc27d0f[_0x4b5865(0xf5)]||'',_0x538328=(_0xc27d0f['name']||'')[_0x4b5865(0x121)](),_0x2c1c28=(_0xc27d0f[_0x4b5865(0x160)]||'')[_0x4b5865(0x121)]();if(_0x538328===_0x56ee21&&(!_0x203e87||_0x2c1c28===_0x203e87)&&_0x5d0bc8>=_0x2e9603&&_0x5d0bc8<=_0xae45bf){_0x4a4480['push']({'id':_0x79d10e['id'],'data':_0xc27d0f});const _0x3d4c7c=(_0xc27d0f['status']||'')[_0x4b5865(0x121)]();_0x4b5865(0xcf)===_0x3d4c7c?_0x155877++:_0x4b5865(0xeb)===_0x3d4c7c&&_0x6b21e3++;}}),{'presentCount':_0x155877,'absentCount':_0x6b21e3,'totalRecords':_0x155877+_0x6b21e3,'docs':_0x4a4480};}throw new Error(_0x5bcbfc(0xe8));}async function showStudentDetails(_0x230d47){const _0x4cda04=_0x2974;if(!currentClass)return void alert(_0x4cda04(0x12f));const _0x1d91ec=_0x418851=>{const _0x3d78d7=_0x4cda04;if(!_0x418851)return'';const [_0x4e5c61,_0x33ddb9,_0x507e03]=_0x418851[_0x3d78d7(0x12a)]('-');return _0x507e03+'/'+_0x33ddb9+'/'+_0x4e5c61;};document[_0x4cda04(0x154)]('studentDetailsContent')[_0x4cda04(0x10d)]=_0x4cda04(0x100)+escapeHtml(_0x230d47)+_0x4cda04(0x149)+escapeHtml(currentClass)+_0x4cda04(0xd3);const _0x3107f6=document[_0x4cda04(0x154)](_0x4cda04(0x10f));_0x3107f6[_0x4cda04(0xfa)][_0x4cda04(0x13f)]=_0x4cda04(0x14e),_0x3107f6[_0x4cda04(0xe2)](_0x4cda04(0x156),_0x4cda04(0xd0));const _0x3cef23=document['getElementById'](_0x4cda04(0x11d)),_0x2e3a05=document['getElementById']('attendanceNote'),_0x4c0aea=document[_0x4cda04(0x154)](_0x4cda04(0x157)),_0x4ce480=document[_0x4cda04(0x154)]('lateMarksValue');try{_0x3cef23['textContent']='Loading...',_0x4c0aea['textContent']=_0x4cda04(0x145),_0x4ce480['textContent']=_0x4cda04(0x145);const _0x37ed06=await fetchAttendanceForStudentThisMonth(_0x230d47,currentClass),_0xd6d52d=_0x37ed06[_0x4cda04(0x111)]||0x0,_0xafdc23=_0x37ed06[_0x4cda04(0x120)]||0x0,_0x5459fb=_0xd6d52d+_0xafdc23,_0x255d1e=currentMonthRangeISO(),_0xa83db7=_0x1d91ec(_0x255d1e[_0x4cda04(0x159)]),_0x4fa3c0=_0x1d91ec(_0x255d1e['endISO']);if(0x0===_0x5459fb)return _0x3cef23['textContent']=_0x4cda04(0x123),_0x2e3a05[_0x4cda04(0x164)]='No\x20attendance\x20records\x20found\x20for\x20'+_0x230d47+_0x4cda04(0xcc)+_0xa83db7+_0x4cda04(0x131)+_0x4fa3c0+'.',_0x4c0aea['textContent']='—',_0x4ce480[_0x4cda04(0x164)]='—',currentModalStudent=_0x230d47,void(currentModalAttendanceData={'presentCount':0x0,'absentCount':0x0,'totalRecords':0x0,'attendancePercent':0x0,'absentDays':[],'lateCount':0x0,'periodStartISO':_0x255d1e[_0x4cda04(0x159)],'periodEndISO':_0x255d1e[_0x4cda04(0x12c)]});const _0x23eeab=Math['round'](_0xd6d52d/_0x5459fb*0x64);_0x3cef23[_0x4cda04(0x164)]=_0x23eeab+'%\x20('+_0xd6d52d+'/'+_0x5459fb+_0x4cda04(0x153),_0x2e3a05[_0x4cda04(0x164)]=_0x4cda04(0x11b)+_0xa83db7+_0x4cda04(0xef)+_0x4fa3c0;const _0x47d33d=Number(_0x255d1e[_0x4cda04(0x12c)][_0x4cda04(0x12a)]('-')[0x2])||0x1f,_0x4bc8f8=new Set();let _0x26d248=0x0;(_0x37ed06[_0x4cda04(0x125)]||[])['forEach'](_0x464da9=>{const _0x42b294=_0x4cda04,_0x3acb75=_0x464da9[_0x42b294(0x15b)]||{},_0x881492=(_0x3acb75[_0x42b294(0xf5)]||'')[_0x42b294(0x121)]();if(!_0x881492)return;const _0x533e84=_0x881492[_0x42b294(0x12a)]('-');if(0x3!==_0x533e84[_0x42b294(0x134)])return;const _0xd6e13=Number(_0x533e84[0x2]);if(!Number[_0x42b294(0x13d)](_0xd6e13))return;if(_0xd6e13<0x1||_0xd6e13>_0x47d33d)return;const _0x523e10=(_0x3acb75[_0x42b294(0xda)]||'')[_0x42b294(0x121)](),_0x1d9ee2=(_0x3acb75[_0x42b294(0x109)]||'')[_0x42b294(0x121)](),_0xf68bfc=!!_0x3acb75[_0x42b294(0x163)]||_0x42b294(0xdd)===_0x523e10||'Late'===_0x1d9ee2;_0x42b294(0xeb)===_0x1d9ee2&&_0x4bc8f8['add'](_0xd6e13),_0xf68bfc&&_0x26d248++;});const _0x33f6bd=Array[_0x4cda04(0xe4)](_0x4bc8f8)[_0x4cda04(0x15e)]((_0x4b31cc,_0xe16557)=>_0x4b31cc-_0xe16557);_0x4c0aea['textContent']=_0x33f6bd[_0x4cda04(0x134)]?_0x33f6bd['join'](',\x20'):'—',_0x4ce480[_0x4cda04(0x164)]=_0x26d248,currentModalStudent=_0x230d47,currentModalAttendanceData={'presentCount':_0xd6d52d,'absentCount':_0xafdc23,'totalRecords':_0x5459fb,'attendancePercent':_0x23eeab,'absentDays':_0x33f6bd,'lateCount':_0x26d248,'periodStartISO':_0x255d1e[_0x4cda04(0x159)],'periodEndISO':_0x255d1e['endISO']};}catch(_0x120485){console[_0x4cda04(0xe5)](_0x4cda04(0xf1),_0x120485),_0x3cef23[_0x4cda04(0x164)]='Error',_0x2e3a05[_0x4cda04(0x164)]=_0x4cda04(0xd7),_0x4c0aea[_0x4cda04(0x164)]='—',_0x4ce480['textContent']='—';}}function _0x2974(_0x36f30a,_0xc1a9ad){_0x36f30a=_0x36f30a-0xc9;const _0x1a078d=_0x1a07();let _0x2974b7=_0x1a078d[_0x36f30a];return _0x2974b7;}function hideStudentDetailsModal(){const _0x36fe90=_0x2974,_0x5420d1=document[_0x36fe90(0x154)](_0x36fe90(0x10f));_0x5420d1[_0x36fe90(0xfa)]['display']='none',_0x5420d1[_0x36fe90(0xe2)](_0x36fe90(0x156),_0x36fe90(0xf6));}async function checkAttendanceSubmittedForClassDate(_0x4ba744,_0x337f54){const _0xf6f0b4=_0x2974;if(!window['db']||!window[_0xf6f0b4(0x124)])throw new Error(_0xf6f0b4(0x132));const _0x44607a=window[_0xf6f0b4(0x124)](window['db'],_0xf6f0b4(0x112));if(window[_0xf6f0b4(0xd1)]&&window['query']&&window['where'])try{const _0x5ae972=window[_0xf6f0b4(0xee)](_0x44607a,window[_0xf6f0b4(0x110)]('className','==',_0x4ba744),window[_0xf6f0b4(0x110)](_0xf6f0b4(0xf5),'==',_0x337f54));return!(await window['getDocs'](_0x5ae972))[_0xf6f0b4(0x104)];}catch(_0x346978){console['error'](_0xf6f0b4(0x13a),_0x346978);}if(window[_0xf6f0b4(0xd1)]){const _0x1a4ac3=await window[_0xf6f0b4(0xd1)](_0x44607a);let _0x4100fc=!0x1;return _0x1a4ac3['forEach'](_0x40f71e=>{const _0x29962c=_0xf6f0b4,_0x308bcb=_0x40f71e['data']?_0x40f71e[_0x29962c(0x15b)]():_0x40f71e['_document'];_0x308bcb&&(_0x308bcb[_0x29962c(0x160)]||'')===_0x4ba744&&(_0x308bcb[_0x29962c(0xf5)]||'')===_0x337f54&&(_0x4100fc=!0x0);}),_0x4100fc;}throw new Error(_0xf6f0b4(0xd9));}function shareStudentFromModal(){const _0x3c8bfe=_0x2974;if(!currentModalStudent)return void alert(_0x3c8bfe(0x10e));if(!currentModalAttendanceData)return void alert(_0x3c8bfe(0x128));const _0x1e6901=_0x1b18e9=>{if(!_0x1b18e9)return'';const [_0x357521,_0x1229a5,_0x2342d8]=_0x1b18e9['split']('-');return _0x2342d8+'/'+_0x1229a5+'/'+_0x357521;},_0x4df35a=(currentModalAttendanceData[_0x3c8bfe(0x142)]||currentMonthRangeISO()[_0x3c8bfe(0x159)])[_0x3c8bfe(0x12a)]('-'),_0x57a216=Number(_0x4df35a[0x1])-0x1,_0x83994e=_0x4df35a[0x0],_0x2dfcfd=_0x3c8bfe(0x14c)+([_0x3c8bfe(0x10a),'February',_0x3c8bfe(0x14a),_0x3c8bfe(0x15d),_0x3c8bfe(0x130),_0x3c8bfe(0x127),_0x3c8bfe(0x14b),_0x3c8bfe(0x11e),_0x3c8bfe(0x138),_0x3c8bfe(0xcb),_0x3c8bfe(0xd2),_0x3c8bfe(0xe1)][_0x57a216]||'')+'\x20'+_0x83994e,_0x4e48f9=_0x3c8bfe(0xf2)+currentModalStudent,_0x29d657=_0x3c8bfe(0x162)+escapeHtml(currentClass||''),_0x166038='Period:\x20'+_0x1e6901(currentModalAttendanceData['periodStartISO'])+'\x20→\x20'+_0x1e6901(currentModalAttendanceData[_0x3c8bfe(0x12e)]),_0x51b82b=currentModalAttendanceData['totalRecords']>0x0?_0x3c8bfe(0x10b)+currentModalAttendanceData[_0x3c8bfe(0xec)]+_0x3c8bfe(0x11c)+currentModalAttendanceData[_0x3c8bfe(0x111)]+'/'+currentModalAttendanceData[_0x3c8bfe(0x136)]+'\x20present)':_0x3c8bfe(0x148),_0xf9716a=currentModalAttendanceData[_0x3c8bfe(0x103)]&&currentModalAttendanceData['absentDays'][_0x3c8bfe(0x134)]?_0x3c8bfe(0xcd)+currentModalAttendanceData[_0x3c8bfe(0x103)][_0x3c8bfe(0xd4)](',\x20'):'Absent\x20on:\x20—',_0x24e575=_0x3c8bfe(0xc9)+(currentModalAttendanceData[_0x3c8bfe(0x150)]||0x0),_0x3b6976='https://wa.me/?text='+encodeURIComponent(_0x2dfcfd+'\x0a\x0a'+_0x4e48f9+'\x0a'+_0x29d657+'\x0a'+_0x166038+'\x0a'+_0x51b82b+'\x0a'+_0xf9716a+'\x0a'+_0x24e575+_0x3c8bfe(0x144));window['open'](_0x3b6976,_0x3c8bfe(0xd6));}async function downloadCSV(){const _0x2013a0=_0x2974;try{const _0x17c147=new Date(),_0x327c24=_0x17c147[_0x2013a0(0x11a)](),_0x57ee33=_0x17c147[_0x2013a0(0xfd)](),_0x158558=new Date(_0x327c24,_0x57ee33+0x1,0x0)['getDate']();if(_0x17c147[_0x2013a0(0xf7)]()!==_0x158558||_0x17c147['getHours']()<0x16)return void alert(_0x2013a0(0x140));if(!window['db']||!window['collection']||!window['getDocs'])return void alert('Firestore\x20APIs\x20not\x20available\x20on\x20window.\x20Ensure\x20window.db,\x20window.collection,\x20and\x20window.getDocs\x20are\x20exposed.');const {startISO:_0x47e1eb,endISO:_0x39955e}=currentMonthRangeISO(),_0x23c173=window[_0x2013a0(0x124)](window['db'],_0x2013a0(0x112));let _0x3241f5;if(window[_0x2013a0(0xee)]&&window[_0x2013a0(0x110)])try{const _0x53d3d5=window['query'](_0x23c173,window['where']('date','>=',_0x47e1eb),window[_0x2013a0(0x110)]('date','<=',_0x39955e));_0x3241f5=await window[_0x2013a0(0xd1)](_0x53d3d5);}catch(_0x2ae655){console[_0x2013a0(0x108)]('Date-range\x20query\x20failed,\x20falling\x20back\x20to\x20full\x20collection\x20read:',_0x2ae655),_0x3241f5=await window[_0x2013a0(0xd1)](_0x23c173);}else _0x3241f5=await window[_0x2013a0(0xd1)](_0x23c173);const _0x1c5ad8=_0x5a3d2b=>{const _0x3b1c0e=_0x2013a0;if(!_0x5a3d2b)return'';if(_0x3b1c0e(0xff)==typeof _0x5a3d2b)return _0x5a3d2b;if(_0x3b1c0e(0x152)==typeof _0x5a3d2b[_0x3b1c0e(0x13c)])try{return _0x5a3d2b[_0x3b1c0e(0x13c)]()[_0x3b1c0e(0x102)]()[_0x3b1c0e(0x13b)](0x0,0xa);}catch{return'';}return _0x5a3d2b instanceof Date?_0x5a3d2b[_0x3b1c0e(0x102)]()[_0x3b1c0e(0x13b)](0x0,0xa):String(_0x5a3d2b||'');},_0x4c1578=_0x842f13=>_0x2013a0(0x152)==typeof _0x842f13['data']?_0x842f13['data']():_0x842f13[_0x2013a0(0xe9)]||{},_0x15fb25=new Map();_0x3241f5[_0x2013a0(0x118)](_0x49e74f=>{const _0x70861b=_0x2013a0,_0x3c7933=_0x4c1578(_0x49e74f);if(!_0x3c7933)return;const _0x169b17=_0x1c5ad8(_0x3c7933[_0x70861b(0xf5)]);if(!_0x169b17)return;if(_0x169b17<_0x47e1eb||_0x169b17>_0x39955e)return;const _0x1ffdfc=(_0x3c7933['name']||'')[_0x70861b(0x121)]()['trim']();if(!_0x1ffdfc)return;const _0x197ea8=(_0x3c7933[_0x70861b(0x160)]||'')['toString']()[_0x70861b(0x161)](),_0x13b64d=_0x1ffdfc+'||'+_0x197ea8;let _0x541bb0=_0x15fb25['get'](_0x13b64d);_0x541bb0||(_0x541bb0={'name':_0x1ffdfc,'className':_0x197ea8,'presentCount':0x0,'absentCount':0x0,'lateCount':0x0,'absentDaysSet':new Set()},_0x15fb25[_0x70861b(0xdc)](_0x13b64d,_0x541bb0));const _0x1d9958=(_0x3c7933['status']||'')[_0x70861b(0x121)]();if(_0x70861b(0xcf)===_0x1d9958)_0x541bb0[_0x70861b(0x111)]++;else{if(_0x70861b(0xeb)===_0x1d9958){_0x541bb0['absentCount']++;const _0xa9251c=_0x169b17[_0x70861b(0x12a)]('-');if(0x3===_0xa9251c[_0x70861b(0x134)]){const _0x14660e=Number(_0xa9251c[0x2]);Number[_0x70861b(0x13d)](_0x14660e)&&_0x541bb0[_0x70861b(0x14d)][_0x70861b(0x14f)](_0x14660e);}}}const _0x1edbca=(_0x3c7933[_0x70861b(0xda)]||'')[_0x70861b(0x121)]();(!!_0x3c7933[_0x70861b(0x163)]||_0x70861b(0xdd)===_0x1edbca||_0x70861b(0xdd)===_0x1d9958)&&_0x541bb0[_0x70861b(0x150)]++;});const _0x2b742f=_0x5e51c0=>{const _0x4ec1ee=_0x2013a0;if(null==_0x5e51c0)return'';return'\x22'+String(_0x5e51c0)[_0x4ec1ee(0xca)](/"/g,'\x22\x22')+'\x22';},_0x4b5543=['5icse',_0x2013a0(0x113),_0x2013a0(0x137),_0x2013a0(0xdf),_0x2013a0(0x135),_0x2013a0(0xed),_0x2013a0(0xf3),_0x2013a0(0x147),_0x2013a0(0x13e)],_0x5eead8=Array[_0x2013a0(0xe4)](_0x15fb25['values']());_0x5eead8[_0x2013a0(0x15e)]((_0x3aee21,_0x2ccc30)=>{const _0x4b93bb=_0x2013a0,_0x2fcdfe=_0x4b5543[_0x4b93bb(0x129)](_0x3aee21['className'][_0x4b93bb(0x115)]()),_0x2b12d5=_0x4b5543[_0x4b93bb(0x129)](_0x2ccc30['className'][_0x4b93bb(0x115)]());return-0x1===_0x2fcdfe&&-0x1===_0x2b12d5?_0x3aee21[_0x4b93bb(0x160)]['localeCompare'](_0x2ccc30['className']):-0x1===_0x2fcdfe?0x1:-0x1===_0x2b12d5?-0x1:_0x2fcdfe!==_0x2b12d5?_0x2fcdfe-_0x2b12d5:_0x3aee21['name']['localeCompare'](_0x2ccc30[_0x4b93bb(0x15a)]);});const _0x365a43=[];_0x365a43[_0x2013a0(0x15c)]([_0x2013a0(0xe3),_0x2013a0(0x114),_0x2013a0(0xe6),'Late\x20Marks\x20This\x20Month',_0x2013a0(0x107)][_0x2013a0(0xd4)](','));for(const _0x4850e4 of _0x5eead8){const _0x23a40e=_0x4850e4['presentCount']||0x0,_0x1f07bc=_0x23a40e+(_0x4850e4[_0x2013a0(0x120)]||0x0),_0xed472=_0x1f07bc?Math[_0x2013a0(0x146)](_0x23a40e/_0x1f07bc*0x64):_0x2013a0(0x101),_0x3b6bfb=Array[_0x2013a0(0xe4)](_0x4850e4[_0x2013a0(0x14d)])[_0x2013a0(0x15e)]((_0xfffb32,_0xb4cb14)=>_0xfffb32-_0xb4cb14),_0x4fda66=_0x3b6bfb['length']?_0x3b6bfb[_0x2013a0(0xd4)](',\x20'):'-';_0x365a43[_0x2013a0(0x15c)]([_0x2b742f(_0x4850e4[_0x2013a0(0x15a)]),_0x2b742f(_0x4850e4[_0x2013a0(0x160)]||'-'),_0x2b742f(_0x4fda66),_0x2b742f(_0x4850e4[_0x2013a0(0x150)]),_0x2b742f(_0xed472)]['join'](','));}if(_0x365a43['length']<=0x1)return void alert(_0x2013a0(0xce));const _0x417374='\ufeff'+_0x365a43[_0x2013a0(0xd4)]('\x0d\x0a'),_0x16c666=new Blob([_0x417374],{'type':_0x2013a0(0xe7)}),_0x3c3aa6=URL[_0x2013a0(0x117)](_0x16c666),_0x150f7c=_0x4884c9=>String(_0x4884c9)[_0x2013a0(0x15f)](0x2,'0'),_0x4c412a=_0x2013a0(0x122)+_0x327c24+'-'+_0x150f7c(_0x57ee33+0x1)+'-'+_0x150f7c(_0x158558)+_0x2013a0(0x11f),_0x30a342=document[_0x2013a0(0x106)]('a');_0x30a342[_0x2013a0(0xf9)]=_0x3c3aa6,_0x30a342['download']=_0x4c412a,document[_0x2013a0(0x139)][_0x2013a0(0xfb)](_0x30a342),_0x30a342[_0x2013a0(0x141)](),_0x30a342[_0x2013a0(0x12b)](),URL[_0x2013a0(0x10c)](_0x3c3aa6),alert('CSV\x20prepared\x20and\x20downloaded\x20successfully.');}catch(_0x58644d){console[_0x2013a0(0xe5)]('downloadCSV\x20failed:',_0x58644d),alert(_0x2013a0(0xfe));}}window['addEventListener'](_0x5430a5(0x158),loadStudentData);
