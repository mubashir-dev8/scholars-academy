function _0x295b(_0x356cff,_0x430129){const _0x55324f=_0x5532();return _0x295b=function(_0x295b7f,_0x289d45){_0x295b7f=_0x295b7f-0x16d;let _0x1b740d=_0x55324f[_0x295b7f];return _0x1b740d;},_0x295b(_0x356cff,_0x430129);}const _0x419546=_0x295b;function _0x5532(){const _0x2fec90=['Error','Attendance\x20data\x20not\x20yet\x20available.\x20Please\x20wait\x20until\x20the\x20modal\x20finishes\x20loading.','flex','toISOString','_document','</div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22\x20id=\x22attendanceNote\x22\x20style=\x22font-size:13px;color:#666;margin-top:8px;\x22></div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22\x20id=\x22attendancePercentRow\x22><strong>Attendance\x20%\x20(this\x20month):</strong>\x20<span\x20id=\x22attendancePercentValue\x22>Loading...</span></div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22><strong>Absent\x20On:</strong>\x20<span\x20id=\x22absentDatesList\x22>Loading...</span></div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22\x20id=\x22lateMarksRow\x22\x20style=\x22margin-top:10px;\x22><strong>Late\x20Marks\x20(this\x20month):</strong>\x20<span\x20id=\x22lateMarksValue\x22>Loading...</span></div>\x0a\x20\x20','.csv','\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22><strong>Name:</strong>\x20','collection','DOMContentLoaded','absentDaysSet','body','7icse','error','periodEndISO','trim','❌\x20Error\x20loading\x20student\x20data:','attendance_records','splice','getDocs','endISO','August','getDate','May','round','Date-range\x20query\x20failed,\x20falling\x20back\x20to\x20full\x20collection\x20read:','Class:\x20','from','absentDatesList','toLowerCase','getHours','string','%\x20(','Firestore\x20read\x20functions\x20(getDocs/query/where)\x20are\x20not\x20exposed\x20on\x20window.\x20Please\x20export\x20them\x20in\x20your\x20head\x20module\x20script.','9sym','join','get','No\x20attendance\x20records\x20found\x20for\x20the\x20current\x20month\x20to\x20export.','function','originalStatus','toDate','late\x20marks\x20this\x20month','getElementById','9gen','10icse','addEventListener','No\x20records','getMonth','revokeObjectURL','values','Absent\x20on:\x20','72Imnwqt','replace','Firestore\x20query\x20failed\x20—\x20falling\x20back\x20to\x20client-side\x20filter:','slice','studentName\x20is\x20required','href','Late','Present','style','December','Failed\x20to\x20fetch\x20attendance.\x20See\x20console\x20for\x20details.','toString','presentCount','1150644dYgLNV','data','length','lateCount','date','Attendance:\x20No\x20records\x20this\x20month','docs','isFinite','625POGBZA','getFullYear','Scholars\x20Academy\x20Attendance\x20Report\x20for\x20','Name:\x20','studentDetailsContent','Failed\x20to\x20fetch\x20attendance\x20for\x20student:','Period:\x20','add','\x20between\x20','empty','setAttribute','6402753DxzQvH','\x20and\x20','Firestore\x20not\x20available.','periodStartISO','warn','where','remove','split','sort','name','Firestore\x20not\x20available.\x20Ensure\x20window.db\x20and\x20window.collection\x20are\x20exposed\x20from\x20your\x20head\x20module\x20script.','localeCompare','1901229UDhrmE','open','21220VHNWPv','forEach','March','\x20→\x20','undefined','_blank','aria-hidden','July','className','query','download','indexOf','false','Loading...','January','\x20present)','true','attendancePercentValue','none','textContent','fetchAttendanceForStudentThisMonth:\x20className\x20not\x20provided\x20and\x20currentClass\x20is\x20not\x20set.\x20Query\x20will\x20match\x20only\x20by\x20name.','startISO','Attendance:\x20','isLate','absentDays','9icse','10ssc','4IqOchz','206038PSkfCe','Absent','display','createElement','status','studentDetailsModal','6629440SqfSuV','710690KcfIIr','No\x20records\x20this\x20month','https://wa.me/?text=','</div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22><strong>Class:</strong>\x20','set','push','April'];_0x5532=function(){return _0x2fec90;};return _0x5532();}(function(_0x113698,_0x3ababc){const _0x293081=_0x295b,_0x5171a6=_0x113698();while(!![]){try{const _0x2e7f91=-parseInt(_0x293081(0x1b3))/0x1*(-parseInt(_0x293081(0x1b2))/0x2)+-parseInt(_0x293081(0x195))/0x3+parseInt(_0x293081(0x197))/0x4*(-parseInt(_0x293081(0x17e))/0x5)+parseInt(_0x293081(0x176))/0x6+parseInt(_0x293081(0x189))/0x7+parseInt(_0x293081(0x1b9))/0x8+-parseInt(_0x293081(0x1f4))/0x9*(parseInt(_0x293081(0x1ba))/0xa);if(_0x2e7f91===_0x3ababc)break;else _0x5171a6['push'](_0x5171a6['shift']());}catch(_0xb8a58f){_0x5171a6['push'](_0x5171a6['shift']());}}}(_0x5532,0x759fd));let studentData={},currentModalStudent=null,currentModalAttendanceData=null;async function loadStudentData(){const _0x4178d9=_0x295b;try{const _0x2be1f5=await fetch('studentData.json');if(!_0x2be1f5['ok'])throw new Error('Failed\x20to\x20load\x20studentData.json');studentData=await _0x2be1f5['json']();}catch(_0x1df358){console[_0x4178d9(0x1ce)](_0x4178d9(0x1d1),_0x1df358);}}function currentMonthRangeISO(){const _0x5ac0c3=_0x295b,_0x262f1c=new Date(),_0xe0110a=_0x262f1c[_0x5ac0c3(0x17f)](),_0xd05f5=_0x262f1c['getMonth'](),_0x43113d=new Date(_0xe0110a,_0xd05f5,0x1),_0x460d7c=new Date(_0xe0110a,_0xd05f5+0x1,0x0),_0x46373c=_0x250a5e=>String(_0x250a5e)['padStart'](0x2,'0'),_0x553f19=_0x2cb0f=>_0x2cb0f[_0x5ac0c3(0x17f)]()+'-'+_0x46373c(_0x2cb0f[_0x5ac0c3(0x1f0)]()+0x1)+'-'+_0x46373c(_0x2cb0f[_0x5ac0c3(0x1d7)]());return{'startISO':_0x553f19(_0x43113d),'endISO':_0x553f19(_0x460d7c)};}async function fetchAttendanceForStudentThisMonth(_0x1678f0,_0x2ff788){const _0x23be5e=_0x295b;if(_0x2ff788=_0x2ff788||(_0x23be5e(0x19b)!=typeof currentClass?currentClass:null),!window['db']||!window[_0x23be5e(0x1c9)])throw new Error(_0x23be5e(0x193));if(!_0x1678f0)throw new Error(_0x23be5e(0x16d));_0x2ff788||console['warn'](_0x23be5e(0x1ab));const {startISO:_0xccaa34,endISO:_0x54500d}=currentMonthRangeISO(),_0x4c3565=window[_0x23be5e(0x1c9)](window['db'],_0x23be5e(0x1d2)),_0x436822=_0x5c568d=>'function'==typeof _0x5c568d[_0x23be5e(0x177)]?_0x5c568d['data']():_0x5c568d[_0x23be5e(0x1c5)]||{};if(window[_0x23be5e(0x1d4)]&&window[_0x23be5e(0x1a0)]&&window['where'])try{const _0x43dbcc=[window[_0x23be5e(0x18e)]('name','==',_0x1678f0),window[_0x23be5e(0x18e)](_0x23be5e(0x17a),'>=',_0xccaa34),window[_0x23be5e(0x18e)](_0x23be5e(0x17a),'<=',_0x54500d)];_0x2ff788&&_0x43dbcc[_0x23be5e(0x1d3)](0x1,0x0,window[_0x23be5e(0x18e)](_0x23be5e(0x19f),'==',_0x2ff788));const _0x283ec6=window[_0x23be5e(0x1a0)](_0x4c3565,..._0x43dbcc),_0x411c82=await window[_0x23be5e(0x1d4)](_0x283ec6);let _0x3385a6=0x0,_0x224c63=0x0;const _0x263cbb=[];return _0x411c82[_0x23be5e(0x198)](_0x130968=>{const _0x53ea74=_0x23be5e,_0x5cda74=_0x436822(_0x130968);_0x263cbb[_0x53ea74(0x1bf)]({'id':_0x130968['id'],'data':_0x5cda74});const _0x18d515=(_0x5cda74[_0x53ea74(0x1b7)]||'')[_0x53ea74(0x174)]();'Present'===_0x18d515?_0x3385a6++:'Absent'===_0x18d515&&_0x224c63++;}),{'presentCount':_0x3385a6,'absentCount':_0x224c63,'totalRecords':_0x3385a6+_0x224c63,'docs':_0x263cbb};}catch(_0x39d617){console[_0x23be5e(0x1ce)](_0x23be5e(0x1f6),_0x39d617);}if(window['getDocs']){const _0x446c68=await window[_0x23be5e(0x1d4)](_0x4c3565);let _0x39da4e=0x0,_0x55e7ee=0x0;const _0x5d94a4=[];return _0x446c68[_0x23be5e(0x198)](_0x49ab65=>{const _0x294d36=_0x23be5e,_0x391b61=_0x436822(_0x49ab65);if(!_0x391b61)return;const _0x3490a1=_0x391b61[_0x294d36(0x17a)]||'',_0x26fe8b=(_0x391b61[_0x294d36(0x192)]||'')[_0x294d36(0x174)](),_0x2eb236=(_0x391b61[_0x294d36(0x19f)]||'')[_0x294d36(0x174)]();if(_0x26fe8b===_0x1678f0&&(!_0x2ff788||_0x2eb236===_0x2ff788)&&_0x3490a1>=_0xccaa34&&_0x3490a1<=_0x54500d){_0x5d94a4[_0x294d36(0x1bf)]({'id':_0x49ab65['id'],'data':_0x391b61});const _0x1b807f=(_0x391b61[_0x294d36(0x1b7)]||'')[_0x294d36(0x174)]();_0x294d36(0x170)===_0x1b807f?_0x39da4e++:_0x294d36(0x1b4)===_0x1b807f&&_0x55e7ee++;}}),{'presentCount':_0x39da4e,'absentCount':_0x55e7ee,'totalRecords':_0x39da4e+_0x55e7ee,'docs':_0x5d94a4};}throw new Error(_0x23be5e(0x1e2));}async function showStudentDetails(_0x3f00c1){const _0x80ed18=_0x295b;if(!currentClass)return void alert('Please\x20select\x20a\x20class\x20first.');const _0x104025=_0x189941=>{const _0x255942=_0x295b;if(!_0x189941)return'';const [_0x1534ea,_0x256d7b,_0x5e94ff]=_0x189941[_0x255942(0x190)]('-');return _0x5e94ff+'/'+_0x256d7b+'/'+_0x1534ea;};document[_0x80ed18(0x1eb)](_0x80ed18(0x182))['innerHTML']=_0x80ed18(0x1c8)+escapeHtml(_0x3f00c1)+_0x80ed18(0x1bd)+escapeHtml(currentClass)+_0x80ed18(0x1c6);const _0x543809=document[_0x80ed18(0x1eb)](_0x80ed18(0x1b8));_0x543809[_0x80ed18(0x171)][_0x80ed18(0x1b5)]=_0x80ed18(0x1c3),_0x543809[_0x80ed18(0x188)](_0x80ed18(0x19d),_0x80ed18(0x1a3));const _0x431d6d=document[_0x80ed18(0x1eb)](_0x80ed18(0x1a8)),_0x2ae125=document[_0x80ed18(0x1eb)]('attendanceNote'),_0x1e7b8e=document['getElementById'](_0x80ed18(0x1dd)),_0x2a76c2=document[_0x80ed18(0x1eb)]('lateMarksValue');try{_0x431d6d[_0x80ed18(0x1aa)]=_0x80ed18(0x1a4),_0x1e7b8e['textContent']=_0x80ed18(0x1a4),_0x2a76c2[_0x80ed18(0x1aa)]=_0x80ed18(0x1a4);const _0x5d0843=await fetchAttendanceForStudentThisMonth(_0x3f00c1,currentClass),_0x4cf2f3=_0x5d0843[_0x80ed18(0x175)]||0x0,_0x4b9fee=_0x5d0843['absentCount']||0x0,_0x5b7599=_0x4cf2f3+_0x4b9fee,_0x2d55ff=currentMonthRangeISO(),_0x315394=_0x104025(_0x2d55ff[_0x80ed18(0x1ac)]),_0x1b7bc2=_0x104025(_0x2d55ff['endISO']);if(0x0===_0x5b7599)return _0x431d6d[_0x80ed18(0x1aa)]=_0x80ed18(0x1bb),_0x2ae125[_0x80ed18(0x1aa)]='No\x20attendance\x20records\x20found\x20for\x20'+_0x3f00c1+_0x80ed18(0x186)+_0x315394+_0x80ed18(0x18a)+_0x1b7bc2+'.',_0x1e7b8e[_0x80ed18(0x1aa)]='—',_0x2a76c2['textContent']='—',currentModalStudent=_0x3f00c1,void(currentModalAttendanceData={'presentCount':0x0,'absentCount':0x0,'totalRecords':0x0,'attendancePercent':0x0,'absentDays':[],'lateCount':0x0,'periodStartISO':_0x2d55ff[_0x80ed18(0x1ac)],'periodEndISO':_0x2d55ff[_0x80ed18(0x1d5)]});const _0x9d2ca4=Math['round'](_0x4cf2f3/_0x5b7599*0x64);_0x431d6d[_0x80ed18(0x1aa)]=_0x9d2ca4+_0x80ed18(0x1e1)+_0x4cf2f3+'/'+_0x5b7599+_0x80ed18(0x1a6),_0x2ae125['textContent']=_0x80ed18(0x184)+_0x315394+_0x80ed18(0x19a)+_0x1b7bc2;const _0x39496b=Number(_0x2d55ff[_0x80ed18(0x1d5)]['split']('-')[0x2])||0x1f,_0x245696=new Set();let _0x524dca=0x0;(_0x5d0843[_0x80ed18(0x17c)]||[])[_0x80ed18(0x198)](_0x302f08=>{const _0xe0969c=_0x80ed18,_0x1c3355=_0x302f08['data']||{},_0x236c54=(_0x1c3355['date']||'')[_0xe0969c(0x174)]();if(!_0x236c54)return;const _0x5ab283=_0x236c54[_0xe0969c(0x190)]('-');if(0x3!==_0x5ab283[_0xe0969c(0x178)])return;const _0x4696a9=Number(_0x5ab283[0x2]);if(!Number['isFinite'](_0x4696a9))return;if(_0x4696a9<0x1||_0x4696a9>_0x39496b)return;const _0x696e63=(_0x1c3355[_0xe0969c(0x1e8)]||'')[_0xe0969c(0x174)](),_0x5afa7a=(_0x1c3355[_0xe0969c(0x1b7)]||'')['toString'](),_0x423b8d=!!_0x1c3355['isLate']||_0xe0969c(0x16f)===_0x696e63||_0xe0969c(0x16f)===_0x5afa7a;_0xe0969c(0x1b4)===_0x5afa7a&&_0x245696[_0xe0969c(0x185)](_0x4696a9),_0x423b8d&&_0x524dca++;});const _0x3c6d1f=Array['from'](_0x245696)[_0x80ed18(0x191)]((_0x432062,_0x167298)=>_0x432062-_0x167298);_0x1e7b8e[_0x80ed18(0x1aa)]=_0x3c6d1f[_0x80ed18(0x178)]?_0x3c6d1f[_0x80ed18(0x1e4)](',\x20'):'—',_0x2a76c2['textContent']=_0x524dca,currentModalStudent=_0x3f00c1,currentModalAttendanceData={'presentCount':_0x4cf2f3,'absentCount':_0x4b9fee,'totalRecords':_0x5b7599,'attendancePercent':_0x9d2ca4,'absentDays':_0x3c6d1f,'lateCount':_0x524dca,'periodStartISO':_0x2d55ff[_0x80ed18(0x1ac)],'periodEndISO':_0x2d55ff[_0x80ed18(0x1d5)]};}catch(_0x46fe7f){console[_0x80ed18(0x1ce)](_0x80ed18(0x183),_0x46fe7f),_0x431d6d[_0x80ed18(0x1aa)]=_0x80ed18(0x1c1),_0x2ae125[_0x80ed18(0x1aa)]=_0x80ed18(0x173),_0x1e7b8e[_0x80ed18(0x1aa)]='—',_0x2a76c2['textContent']='—';}}function hideStudentDetailsModal(){const _0x3af1e9=_0x295b,_0x528305=document[_0x3af1e9(0x1eb)]('studentDetailsModal');_0x528305[_0x3af1e9(0x171)][_0x3af1e9(0x1b5)]=_0x3af1e9(0x1a9),_0x528305[_0x3af1e9(0x188)](_0x3af1e9(0x19d),_0x3af1e9(0x1a7));}async function checkAttendanceSubmittedForClassDate(_0x32656c,_0x1d6903){const _0x4e35a0=_0x295b;if(!window['db']||!window[_0x4e35a0(0x1c9)])throw new Error(_0x4e35a0(0x18b));const _0x2a130f=window[_0x4e35a0(0x1c9)](window['db'],_0x4e35a0(0x1d2));if(window[_0x4e35a0(0x1d4)]&&window[_0x4e35a0(0x1a0)]&&window[_0x4e35a0(0x18e)])try{const _0x332380=window[_0x4e35a0(0x1a0)](_0x2a130f,window[_0x4e35a0(0x18e)](_0x4e35a0(0x19f),'==',_0x32656c),window['where'](_0x4e35a0(0x17a),'==',_0x1d6903));return!(await window[_0x4e35a0(0x1d4)](_0x332380))[_0x4e35a0(0x187)];}catch(_0x34c7b6){console['error']('checkAttendance\x20query\x20failed,\x20falling\x20back:',_0x34c7b6);}if(window[_0x4e35a0(0x1d4)]){const _0x1b6155=await window[_0x4e35a0(0x1d4)](_0x2a130f);let _0x418b3e=!0x1;return _0x1b6155[_0x4e35a0(0x198)](_0x2bf0f9=>{const _0x5e5331=_0x4e35a0,_0x5759bb=_0x2bf0f9['data']?_0x2bf0f9['data']():_0x2bf0f9[_0x5e5331(0x1c5)];_0x5759bb&&(_0x5759bb[_0x5e5331(0x19f)]||'')===_0x32656c&&(_0x5759bb[_0x5e5331(0x17a)]||'')===_0x1d6903&&(_0x418b3e=!0x0);}),_0x418b3e;}throw new Error('No\x20Firestore\x20read\x20APIs\x20exposed\x20on\x20window.');}function shareStudentFromModal(){const _0x44c63e=_0x295b;if(!currentModalStudent)return void alert('No\x20student\x20is\x20currently\x20loaded\x20to\x20share.\x20Open\x20a\x20student\x20first.');if(!currentModalAttendanceData)return void alert(_0x44c63e(0x1c2));const _0x76b37b=_0x5e9629=>{const _0x550b8a=_0x44c63e;if(!_0x5e9629)return'';const [_0x7eeaa1,_0x130773,_0x3d90cf]=_0x5e9629[_0x550b8a(0x190)]('-');return _0x3d90cf+'/'+_0x130773+'/'+_0x7eeaa1;},_0x34f88e=(currentModalAttendanceData['periodStartISO']||currentMonthRangeISO()[_0x44c63e(0x1ac)])['split']('-'),_0xf88067=Number(_0x34f88e[0x1])-0x1,_0xe0d28f=_0x34f88e[0x0],_0x4e9d5c=_0x44c63e(0x180)+([_0x44c63e(0x1a5),'February',_0x44c63e(0x199),_0x44c63e(0x1c0),_0x44c63e(0x1d8),'June',_0x44c63e(0x19e),_0x44c63e(0x1d6),'September','October','November',_0x44c63e(0x172)][_0xf88067]||'')+'\x20'+_0xe0d28f,_0x4858a5=_0x44c63e(0x181)+currentModalStudent,_0x174219=_0x44c63e(0x1db)+escapeHtml(currentClass||''),_0x49400e=_0x44c63e(0x184)+_0x76b37b(currentModalAttendanceData[_0x44c63e(0x18c)])+_0x44c63e(0x19a)+_0x76b37b(currentModalAttendanceData[_0x44c63e(0x1cf)]),_0x1e9ec2=currentModalAttendanceData['totalRecords']>0x0?_0x44c63e(0x1ad)+currentModalAttendanceData['attendancePercent']+_0x44c63e(0x1e1)+currentModalAttendanceData[_0x44c63e(0x175)]+'/'+currentModalAttendanceData['totalRecords']+_0x44c63e(0x1a6):_0x44c63e(0x17b),_0x44b691=currentModalAttendanceData[_0x44c63e(0x1af)]&&currentModalAttendanceData[_0x44c63e(0x1af)][_0x44c63e(0x178)]?_0x44c63e(0x1f3)+currentModalAttendanceData[_0x44c63e(0x1af)]['join'](',\x20'):'Absent\x20on:\x20—',_0x1f1b45='Late\x20marks\x20(this\x20month):\x20'+(currentModalAttendanceData['lateCount']||0x0),_0x515912=_0x44c63e(0x1bc)+encodeURIComponent(_0x4e9d5c+'\x0a\x0a'+_0x4858a5+'\x0a'+_0x174219+'\x0a'+_0x49400e+'\x0a'+_0x1e9ec2+'\x0a'+_0x44b691+'\x0a'+_0x1f1b45+'\x0a\x0aIf\x20you\x20have\x20any\x20questions,\x20please\x20contact\x209967772240.');window[_0x44c63e(0x196)](_0x515912,_0x44c63e(0x19c));}async function downloadCSV(){const _0x120cbb=_0x295b;try{const _0x33247=new Date(),_0x1d2366=_0x33247[_0x120cbb(0x17f)](),_0x3cd42e=_0x33247[_0x120cbb(0x1f0)](),_0xbabc74=new Date(_0x1d2366,_0x3cd42e+0x1,0x0)[_0x120cbb(0x1d7)]();if(_0x33247[_0x120cbb(0x1d7)]()!==_0xbabc74||_0x33247[_0x120cbb(0x1df)]()<0x16)return void alert('CSV\x20can\x20only\x20be\x20downloaded\x20on\x20the\x20last\x20date\x20of\x20the\x20month\x20after\x2010:00\x20PM\x20local\x20time.');if(!window['db']||!window[_0x120cbb(0x1c9)]||!window['getDocs'])return void alert('Firestore\x20APIs\x20not\x20available\x20on\x20window.\x20Ensure\x20window.db,\x20window.collection,\x20and\x20window.getDocs\x20are\x20exposed.');const {startISO:_0x1de0bb,endISO:_0x505d2c}=currentMonthRangeISO(),_0x4fda8c=window[_0x120cbb(0x1c9)](window['db'],_0x120cbb(0x1d2));let _0x374fdf;if(window[_0x120cbb(0x1a0)]&&window[_0x120cbb(0x18e)])try{const _0x144a10=window[_0x120cbb(0x1a0)](_0x4fda8c,window[_0x120cbb(0x18e)](_0x120cbb(0x17a),'>=',_0x1de0bb),window['where'](_0x120cbb(0x17a),'<=',_0x505d2c));_0x374fdf=await window[_0x120cbb(0x1d4)](_0x144a10);}catch(_0x417594){console[_0x120cbb(0x18d)](_0x120cbb(0x1da),_0x417594),_0x374fdf=await window[_0x120cbb(0x1d4)](_0x4fda8c);}else _0x374fdf=await window['getDocs'](_0x4fda8c);const _0x5c45cb=_0x6e2458=>{const _0x276d87=_0x120cbb;if(!_0x6e2458)return'';if(_0x276d87(0x1e0)==typeof _0x6e2458)return _0x6e2458;if('function'==typeof _0x6e2458[_0x276d87(0x1e9)])try{return _0x6e2458[_0x276d87(0x1e9)]()[_0x276d87(0x1c4)]()[_0x276d87(0x1f7)](0x0,0xa);}catch{return'';}return _0x6e2458 instanceof Date?_0x6e2458[_0x276d87(0x1c4)]()[_0x276d87(0x1f7)](0x0,0xa):String(_0x6e2458||'');},_0x655310=_0x24dbde=>_0x120cbb(0x1e7)==typeof _0x24dbde[_0x120cbb(0x177)]?_0x24dbde[_0x120cbb(0x177)]():_0x24dbde[_0x120cbb(0x1c5)]||{},_0xd8d050=new Map();_0x374fdf[_0x120cbb(0x198)](_0x4be38d=>{const _0x2676d1=_0x120cbb,_0x20c103=_0x655310(_0x4be38d);if(!_0x20c103)return;const _0xfda5ff=_0x5c45cb(_0x20c103[_0x2676d1(0x17a)]);if(!_0xfda5ff)return;if(_0xfda5ff<_0x1de0bb||_0xfda5ff>_0x505d2c)return;const _0x3aa414=(_0x20c103['name']||'')[_0x2676d1(0x174)]()[_0x2676d1(0x1d0)]();if(!_0x3aa414)return;const _0x1d2e0c=(_0x20c103[_0x2676d1(0x19f)]||'')['toString']()[_0x2676d1(0x1d0)](),_0x576e32=_0x3aa414+'||'+_0x1d2e0c;let _0x461638=_0xd8d050[_0x2676d1(0x1e5)](_0x576e32);_0x461638||(_0x461638={'name':_0x3aa414,'className':_0x1d2e0c,'presentCount':0x0,'absentCount':0x0,'lateCount':0x0,'absentDaysSet':new Set()},_0xd8d050[_0x2676d1(0x1be)](_0x576e32,_0x461638));const _0x3bc0e7=(_0x20c103[_0x2676d1(0x1b7)]||'')[_0x2676d1(0x174)]();if(_0x2676d1(0x170)===_0x3bc0e7)_0x461638[_0x2676d1(0x175)]++;else{if('Absent'===_0x3bc0e7){_0x461638['absentCount']++;const _0x25bfc3=_0xfda5ff['split']('-');if(0x3===_0x25bfc3['length']){const _0x30e5e1=Number(_0x25bfc3[0x2]);Number[_0x2676d1(0x17d)](_0x30e5e1)&&_0x461638['absentDaysSet'][_0x2676d1(0x185)](_0x30e5e1);}}}const _0x23f0d1=(_0x20c103[_0x2676d1(0x1e8)]||'')['toString']();(!!_0x20c103[_0x2676d1(0x1ae)]||_0x2676d1(0x16f)===_0x23f0d1||_0x2676d1(0x16f)===_0x3bc0e7)&&_0x461638[_0x2676d1(0x179)]++;});const _0x52d4f8=_0x293174=>{const _0x597357=_0x120cbb;if(null==_0x293174)return'\x22\x22';return'\x22'+String(_0x293174)[_0x597357(0x1f5)](/"/g,'\x22\x22')+'\x22';},_0x4b37e0=[[_0x120cbb(0x192),'class','absent\x20on',_0x120cbb(0x1ea),'attendance\x20%']['join'](',')+'\x0a'],_0xd8b835=['5icse','6icse',_0x120cbb(0x1cd),'8icse',_0x120cbb(0x1b0),_0x120cbb(0x1ed),_0x120cbb(0x1e3),_0x120cbb(0x1ec),_0x120cbb(0x1b1)],_0xe23d5f=Array[_0x120cbb(0x1dc)](_0xd8d050[_0x120cbb(0x1f2)]());_0xe23d5f[_0x120cbb(0x191)]((_0x1756a6,_0x5aa097)=>{const _0x370dc7=_0x120cbb,_0x2d5c67=_0xd8b835[_0x370dc7(0x1a2)](_0x1756a6[_0x370dc7(0x19f)]['toLowerCase']()),_0x19eeff=_0xd8b835[_0x370dc7(0x1a2)](_0x5aa097[_0x370dc7(0x19f)][_0x370dc7(0x1de)]());return-0x1===_0x2d5c67&&-0x1===_0x19eeff?_0x1756a6[_0x370dc7(0x19f)]['localeCompare'](_0x5aa097[_0x370dc7(0x19f)]):-0x1===_0x2d5c67?0x1:-0x1===_0x19eeff?-0x1:_0x2d5c67!==_0x19eeff?_0x2d5c67-_0x19eeff:_0x1756a6[_0x370dc7(0x192)][_0x370dc7(0x194)](_0x5aa097[_0x370dc7(0x192)]);});for(const _0x334e01 of _0xe23d5f){const _0x426e2c=_0x334e01[_0x120cbb(0x175)]||0x0,_0x2eb094=_0x426e2c+(_0x334e01['absentCount']||0x0),_0x1322f1=_0x2eb094?Math[_0x120cbb(0x1d9)](_0x426e2c/_0x2eb094*0x64):_0x120cbb(0x1ef),_0x59e167=Array[_0x120cbb(0x1dc)](_0x334e01[_0x120cbb(0x1cb)])[_0x120cbb(0x191)]((_0x5b2113,_0x1c0739)=>_0x5b2113-_0x1c0739),_0x443853=_0x59e167[_0x120cbb(0x178)]?_0x59e167[_0x120cbb(0x1e4)](',\x20'):'—',_0x13c711=[_0x52d4f8(_0x334e01[_0x120cbb(0x192)]),_0x52d4f8(_0x334e01[_0x120cbb(0x19f)]||'—'),_0x52d4f8(_0x443853),_0x52d4f8(_0x334e01[_0x120cbb(0x179)]),_0x52d4f8(_0x1322f1)];_0x4b37e0['push'](_0x13c711['join'](',')+'\x0a');}if(0x1===_0x4b37e0[_0x120cbb(0x178)])return void alert(_0x120cbb(0x1e6));const _0x1607dd='\ufeff'+_0x4b37e0[_0x120cbb(0x1e4)](''),_0x29f7f4=new Blob([_0x1607dd],{'type':'text/csv;charset=utf-8;'}),_0x25f98f=URL['createObjectURL'](_0x29f7f4),_0x4ec507=_0x27339c=>String(_0x27339c)['padStart'](0x2,'0'),_0x402d6f='attendance_all_students_'+_0x1d2366+'-'+_0x4ec507(_0x3cd42e+0x1)+'-'+_0x4ec507(_0xbabc74)+_0x120cbb(0x1c7),_0x21ab1d=document[_0x120cbb(0x1b6)]('a');_0x21ab1d[_0x120cbb(0x16e)]=_0x25f98f,_0x21ab1d[_0x120cbb(0x1a1)]=_0x402d6f,document[_0x120cbb(0x1cc)]['appendChild'](_0x21ab1d),_0x21ab1d['click'](),_0x21ab1d[_0x120cbb(0x18f)](),URL[_0x120cbb(0x1f1)](_0x25f98f),alert('CSV\x20prepared\x20and\x20download\x20started\x20for\x20all\x20students,\x20grouped\x20by\x20class\x20order.');}catch(_0x5328d7){console[_0x120cbb(0x1ce)]('downloadCSV\x20failed:',_0x5328d7),alert('Failed\x20to\x20prepare\x20CSV.\x20See\x20console\x20for\x20details.');}}window[_0x419546(0x1ee)](_0x419546(0x1ca),loadStudentData);
