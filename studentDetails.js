const _0x3343b=_0x351b;function _0x3232(){const _0x3f91a1=['\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22><strong>Name:</strong>\x20','studentDetailsContent','originalStatus','absentDaysSet','August','forEach','getFullYear','Firestore\x20not\x20available.','168iINivY','getDocs','absentDays','localeCompare','September','\x20and\x20','data','error','Present','913716AeHBlG','collection','8icse','Date-range\x20query\x20failed,\x20falling\x20back\x20to\x20full\x20collection\x20read:','Late\x20Marks\x20This\x20Month','lateCount','Attendance:\x20No\x20records\x20this\x20month','innerHTML','studentName\x20is\x20required','</div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22><strong>Class:</strong>\x20','toLowerCase','October','Absent\x20on:\x20','add','Absent','query','absentCount','\x20between\x20','10icse','splice','_document','\x20→\x20','open','href','January','Firestore\x20read\x20functions\x20(getDocs/query/where)\x20are\x20not\x20exposed\x20on\x20window.\x20Please\x20export\x20them\x20in\x20your\x20head\x20module\x20script.','6icse','Late','display','Error','No\x20records\x20this\x20month','7icse','No\x20student\x20is\x20currently\x20loaded\x20to\x20share.\x20Open\x20a\x20student\x20first.','1195147iDuoRH','isFinite','slice','toDate','appendChild','attendancePercentValue','Scholars\x20Academy\x20Attendance\x20Report\x20for\x20','studentDetailsModal','length','DOMContentLoaded','studentData.json','function','string','empty','Class:\x20','CSV\x20prepared\x20and\x20downloaded\x20successfully.','getElementById','join','body','text/csv;charset=utf-8','undefined','createObjectURL','trim','indexOf','date','No\x20attendance\x20records\x20found\x20for\x20','lateMarksValue','%\x20(','Period:\x20','9sym','Failed\x20to\x20fetch\x20attendance\x20for\x20student:','startISO','status','periodEndISO','getDate','April','4609059VSQWmn','Late\x20marks\x20(this\x20month):\x20','get','revokeObjectURL','July','726465GbjdXb','attendance_records','download','attendance_all_students_','Firestore\x20APIs\x20not\x20available\x20on\x20window.\x20Ensure\x20window.db,\x20window.collection,\x20and\x20window.getDocs\x20are\x20exposed.','addEventListener','endISO','style','totalRecords','toString','2662188IMarCa','setAttribute','round','Failed\x20to\x20fetch\x20attendance.\x20See\x20console\x20for\x20details.','getHours','813324UtBRkB','split','sort','5nYrptj','</div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22\x20id=\x22attendanceNote\x22\x20style=\x22font-size:13px;color:#666;margin-top:8px;\x22></div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22\x20id=\x22attendancePercentRow\x22><strong>Attendance\x20%\x20(this\x20month):</strong>\x20<span\x20id=\x22attendancePercentValue\x22>Loading...</span></div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22><strong>Absent\x20On:</strong>\x20<span\x20id=\x22absentDatesList\x22>Loading...</span></div>\x0a\x20\x20\x20\x20<div\x20class=\x22row\x22\x20id=\x22lateMarksRow\x22\x20style=\x22margin-top:10px;\x22><strong>Late\x20Marks\x20(this\x20month):</strong>\x20<span\x20id=\x22lateMarksValue\x22>Loading...</span></div>\x0a\x20\x20','December','isLate','_blank','June','9gen','aria-hidden','true','periodStartISO','No\x20attendance\x20records\x20found\x20for\x20the\x20current\x20month\x20to\x20export.','Failed\x20to\x20prepare\x20CSV.\x20See\x20console\x20for\x20details.','className','name','CSV\x20can\x20only\x20be\x20downloaded\x20on\x20the\x20last\x20date\x20of\x20the\x20month\x20after\x2010:00\x20PM\x20local\x20time.','from','replace','500103QtaVpQ','where','5icse','Please\x20select\x20a\x20class\x20first.','presentCount','getMonth','\x20present)','March','docs','.csv','Loading...','Attendance\x20data\x20not\x20yet\x20available.\x20Please\x20wait\x20until\x20the\x20modal\x20finishes\x20loading.','textContent','Name:\x20','push'];_0x3232=function(){return _0x3f91a1;};return _0x3232();}(function(_0x19da46,_0x281bbe){const _0x57c687=_0x351b,_0xece30e=_0x19da46();while(!![]){try{const _0x4519bc=parseInt(_0x57c687(0x22b))/0x1+parseInt(_0x57c687(0x1d6))/0x2+parseInt(_0x57c687(0x1c7))/0x3+-parseInt(_0x57c687(0x20a))/0x4*(parseInt(_0x57c687(0x1d9))/0x5)+-parseInt(_0x57c687(0x1d1))/0x6+parseInt(_0x57c687(0x1c2))/0x7+-parseInt(_0x57c687(0x201))/0x8*(parseInt(_0x57c687(0x1ea))/0x9);if(_0x4519bc===_0x281bbe)break;else _0xece30e['push'](_0xece30e['shift']());}catch(_0x1ed22c){_0xece30e['push'](_0xece30e['shift']());}}}(_0x3232,0xa1f47));let studentData={},currentModalStudent=null,currentModalAttendanceData=null;async function loadStudentData(){const _0x4d4c54=_0x351b;try{const _0x5d028d=await fetch(_0x4d4c54(0x1a8));if(!_0x5d028d['ok'])throw new Error('Failed\x20to\x20load\x20studentData.json');studentData=await _0x5d028d['json']();}catch(_0x1ea355){console[_0x4d4c54(0x208)]('❌\x20Error\x20loading\x20student\x20data:',_0x1ea355);}}function currentMonthRangeISO(){const _0x162045=_0x351b,_0x39a8e2=new Date(),_0x11d3ab=_0x39a8e2['getFullYear'](),_0x4e8ab9=_0x39a8e2['getMonth'](),_0x3a8b31=new Date(_0x11d3ab,_0x4e8ab9,0x1),_0x36bd89=new Date(_0x11d3ab,_0x4e8ab9+0x1,0x0),_0x30fda9=_0x46feeb=>String(_0x46feeb)['padStart'](0x2,'0'),_0x4156eb=_0x777cc=>_0x777cc[_0x162045(0x1ff)]()+'-'+_0x30fda9(_0x777cc[_0x162045(0x1ef)]()+0x1)+'-'+_0x30fda9(_0x777cc[_0x162045(0x1c0)]());return{'startISO':_0x4156eb(_0x3a8b31),'endISO':_0x4156eb(_0x36bd89)};}async function fetchAttendanceForStudentThisMonth(_0x3750ea,_0x4a61b9){const _0x4c61ee=_0x351b;if(_0x4a61b9=_0x4a61b9||(_0x4c61ee(0x1b2)!=typeof currentClass?currentClass:null),!window['db']||!window[_0x4c61ee(0x20b)])throw new Error('Firestore\x20not\x20available.\x20Ensure\x20window.db\x20and\x20window.collection\x20are\x20exposed\x20from\x20your\x20head\x20module\x20script.');if(!_0x3750ea)throw new Error(_0x4c61ee(0x212));_0x4a61b9||console['warn']('fetchAttendanceForStudentThisMonth:\x20className\x20not\x20provided\x20and\x20currentClass\x20is\x20not\x20set.\x20Query\x20will\x20match\x20only\x20by\x20name.');const {startISO:_0x552e69,endISO:_0x1e1821}=currentMonthRangeISO(),_0x4efecf=window[_0x4c61ee(0x20b)](window['db'],_0x4c61ee(0x1c8)),_0x143228=_0x25ad24=>_0x4c61ee(0x1a9)==typeof _0x25ad24[_0x4c61ee(0x207)]?_0x25ad24[_0x4c61ee(0x207)]():_0x25ad24[_0x4c61ee(0x21e)]||{};if(window[_0x4c61ee(0x202)]&&window[_0x4c61ee(0x219)]&&window[_0x4c61ee(0x1eb)])try{const _0x3660e8=[window[_0x4c61ee(0x1eb)](_0x4c61ee(0x1e6),'==',_0x3750ea),window[_0x4c61ee(0x1eb)](_0x4c61ee(0x1b6),'>=',_0x552e69),window[_0x4c61ee(0x1eb)]('date','<=',_0x1e1821)];_0x4a61b9&&_0x3660e8[_0x4c61ee(0x21d)](0x1,0x0,window[_0x4c61ee(0x1eb)](_0x4c61ee(0x1e5),'==',_0x4a61b9));const _0x36e81c=window[_0x4c61ee(0x219)](_0x4efecf,..._0x3660e8),_0x28b807=await window[_0x4c61ee(0x202)](_0x36e81c);let _0x5e1005=0x0,_0x5bfc25=0x0;const _0x5490a8=[];return _0x28b807['forEach'](_0x1d99ba=>{const _0x41fc36=_0x4c61ee,_0x382fae=_0x143228(_0x1d99ba);_0x5490a8[_0x41fc36(0x1f8)]({'id':_0x1d99ba['id'],'data':_0x382fae});const _0x47efff=(_0x382fae[_0x41fc36(0x1be)]||'')['toString']();_0x41fc36(0x209)===_0x47efff?_0x5e1005++:'Absent'===_0x47efff&&_0x5bfc25++;}),{'presentCount':_0x5e1005,'absentCount':_0x5bfc25,'totalRecords':_0x5e1005+_0x5bfc25,'docs':_0x5490a8};}catch(_0x51bc09){console[_0x4c61ee(0x208)]('Firestore\x20query\x20failed\x20—\x20falling\x20back\x20to\x20client-side\x20filter:',_0x51bc09);}if(window['getDocs']){const _0x4625a1=await window[_0x4c61ee(0x202)](_0x4efecf);let _0x5cbd50=0x0,_0x3a9f17=0x0;const _0x4ab588=[];return _0x4625a1[_0x4c61ee(0x1fe)](_0x7d5725=>{const _0x5ef598=_0x4c61ee,_0x3f2dc0=_0x143228(_0x7d5725);if(!_0x3f2dc0)return;const _0x111adf=_0x3f2dc0['date']||'',_0x5a4877=(_0x3f2dc0[_0x5ef598(0x1e6)]||'')[_0x5ef598(0x1d0)](),_0x2437e8=(_0x3f2dc0[_0x5ef598(0x1e5)]||'')[_0x5ef598(0x1d0)]();if(_0x5a4877===_0x3750ea&&(!_0x4a61b9||_0x2437e8===_0x4a61b9)&&_0x111adf>=_0x552e69&&_0x111adf<=_0x1e1821){_0x4ab588['push']({'id':_0x7d5725['id'],'data':_0x3f2dc0});const _0x58fddb=(_0x3f2dc0[_0x5ef598(0x1be)]||'')[_0x5ef598(0x1d0)]();_0x5ef598(0x209)===_0x58fddb?_0x5cbd50++:_0x5ef598(0x218)===_0x58fddb&&_0x3a9f17++;}}),{'presentCount':_0x5cbd50,'absentCount':_0x3a9f17,'totalRecords':_0x5cbd50+_0x3a9f17,'docs':_0x4ab588};}throw new Error(_0x4c61ee(0x223));}function _0x351b(_0x465ebd,_0x379502){const _0x32326d=_0x3232();return _0x351b=function(_0x351b4f,_0x137732){_0x351b4f=_0x351b4f-0x1a3;let _0x2d5877=_0x32326d[_0x351b4f];return _0x2d5877;},_0x351b(_0x465ebd,_0x379502);}async function showStudentDetails(_0x31ef47){const _0x472892=_0x351b;if(!currentClass)return void alert(_0x472892(0x1ed));const _0x5e2c5d=_0x4e1015=>{const _0x2b6b65=_0x472892;if(!_0x4e1015)return'';const [_0x58a65b,_0x303c5b,_0x2561cb]=_0x4e1015[_0x2b6b65(0x1d7)]('-');return _0x2561cb+'/'+_0x303c5b+'/'+_0x58a65b;};document[_0x472892(0x1ae)](_0x472892(0x1fa))[_0x472892(0x211)]=_0x472892(0x1f9)+escapeHtml(_0x31ef47)+_0x472892(0x213)+escapeHtml(currentClass)+_0x472892(0x1da);const _0x455a9b=document[_0x472892(0x1ae)]('studentDetailsModal');_0x455a9b[_0x472892(0x1ce)][_0x472892(0x226)]='flex',_0x455a9b[_0x472892(0x1d2)]('aria-hidden','false');const _0x15369a=document['getElementById'](_0x472892(0x1a3)),_0x4c2d57=document['getElementById']('attendanceNote'),_0x1ad174=document['getElementById']('absentDatesList'),_0x20c2fa=document[_0x472892(0x1ae)](_0x472892(0x1b8));try{_0x15369a[_0x472892(0x1f6)]=_0x472892(0x1f4),_0x1ad174[_0x472892(0x1f6)]=_0x472892(0x1f4),_0x20c2fa[_0x472892(0x1f6)]=_0x472892(0x1f4);const _0x4973f9=await fetchAttendanceForStudentThisMonth(_0x31ef47,currentClass),_0x1cd3e1=_0x4973f9[_0x472892(0x1ee)]||0x0,_0x4b0d3c=_0x4973f9[_0x472892(0x21a)]||0x0,_0x567f92=_0x1cd3e1+_0x4b0d3c,_0x5aa646=currentMonthRangeISO(),_0x4f7b67=_0x5e2c5d(_0x5aa646[_0x472892(0x1bd)]),_0x24bc59=_0x5e2c5d(_0x5aa646[_0x472892(0x1cd)]);if(0x0===_0x567f92)return _0x15369a[_0x472892(0x1f6)]=_0x472892(0x228),_0x4c2d57[_0x472892(0x1f6)]=_0x472892(0x1b7)+_0x31ef47+_0x472892(0x21b)+_0x4f7b67+_0x472892(0x206)+_0x24bc59+'.',_0x1ad174[_0x472892(0x1f6)]='—',_0x20c2fa[_0x472892(0x1f6)]='—',currentModalStudent=_0x31ef47,void(currentModalAttendanceData={'presentCount':0x0,'absentCount':0x0,'totalRecords':0x0,'attendancePercent':0x0,'absentDays':[],'lateCount':0x0,'periodStartISO':_0x5aa646[_0x472892(0x1bd)],'periodEndISO':_0x5aa646[_0x472892(0x1cd)]});const _0x40a30b=Math[_0x472892(0x1d3)](_0x1cd3e1/_0x567f92*0x64);_0x15369a[_0x472892(0x1f6)]=_0x40a30b+'%\x20('+_0x1cd3e1+'/'+_0x567f92+_0x472892(0x1f0),_0x4c2d57[_0x472892(0x1f6)]=_0x472892(0x1ba)+_0x4f7b67+_0x472892(0x21f)+_0x24bc59;const _0x2b2598=Number(_0x5aa646[_0x472892(0x1cd)][_0x472892(0x1d7)]('-')[0x2])||0x1f,_0x2c8393=new Set();let _0x463371=0x0;(_0x4973f9[_0x472892(0x1f2)]||[])[_0x472892(0x1fe)](_0x4f731c=>{const _0x5b8156=_0x472892,_0x5dd2a2=_0x4f731c[_0x5b8156(0x207)]||{},_0x3df174=(_0x5dd2a2[_0x5b8156(0x1b6)]||'')['toString']();if(!_0x3df174)return;const _0x2bb215=_0x3df174[_0x5b8156(0x1d7)]('-');if(0x3!==_0x2bb215['length'])return;const _0x2a37b2=Number(_0x2bb215[0x2]);if(!Number[_0x5b8156(0x22c)](_0x2a37b2))return;if(_0x2a37b2<0x1||_0x2a37b2>_0x2b2598)return;const _0x1a2b60=(_0x5dd2a2[_0x5b8156(0x1fb)]||'')[_0x5b8156(0x1d0)](),_0xb3c3a5=(_0x5dd2a2[_0x5b8156(0x1be)]||'')[_0x5b8156(0x1d0)](),_0x3f0e5c=!!_0x5dd2a2[_0x5b8156(0x1dc)]||_0x5b8156(0x225)===_0x1a2b60||'Late'===_0xb3c3a5;_0x5b8156(0x218)===_0xb3c3a5&&_0x2c8393[_0x5b8156(0x217)](_0x2a37b2),_0x3f0e5c&&_0x463371++;});const _0x55e271=Array[_0x472892(0x1e8)](_0x2c8393)[_0x472892(0x1d8)]((_0x1173ba,_0x8d2aac)=>_0x1173ba-_0x8d2aac);_0x1ad174[_0x472892(0x1f6)]=_0x55e271[_0x472892(0x1a6)]?_0x55e271[_0x472892(0x1af)](',\x20'):'—',_0x20c2fa['textContent']=_0x463371,currentModalStudent=_0x31ef47,currentModalAttendanceData={'presentCount':_0x1cd3e1,'absentCount':_0x4b0d3c,'totalRecords':_0x567f92,'attendancePercent':_0x40a30b,'absentDays':_0x55e271,'lateCount':_0x463371,'periodStartISO':_0x5aa646[_0x472892(0x1bd)],'periodEndISO':_0x5aa646['endISO']};}catch(_0x4f6c4){console[_0x472892(0x208)](_0x472892(0x1bc),_0x4f6c4),_0x15369a['textContent']=_0x472892(0x227),_0x4c2d57[_0x472892(0x1f6)]=_0x472892(0x1d4),_0x1ad174['textContent']='—',_0x20c2fa['textContent']='—';}}function hideStudentDetailsModal(){const _0x2a83ab=_0x351b,_0x57ccb9=document[_0x2a83ab(0x1ae)](_0x2a83ab(0x1a5));_0x57ccb9['style']['display']='none',_0x57ccb9[_0x2a83ab(0x1d2)](_0x2a83ab(0x1e0),_0x2a83ab(0x1e1));}async function checkAttendanceSubmittedForClassDate(_0x3587c4,_0xc129cd){const _0x3055de=_0x351b;if(!window['db']||!window['collection'])throw new Error(_0x3055de(0x200));const _0x4bb679=window[_0x3055de(0x20b)](window['db'],_0x3055de(0x1c8));if(window[_0x3055de(0x202)]&&window[_0x3055de(0x219)]&&window[_0x3055de(0x1eb)])try{const _0x36a044=window[_0x3055de(0x219)](_0x4bb679,window[_0x3055de(0x1eb)](_0x3055de(0x1e5),'==',_0x3587c4),window[_0x3055de(0x1eb)]('date','==',_0xc129cd));return!(await window[_0x3055de(0x202)](_0x36a044))[_0x3055de(0x1ab)];}catch(_0x88322f){console[_0x3055de(0x208)]('checkAttendance\x20query\x20failed,\x20falling\x20back:',_0x88322f);}if(window[_0x3055de(0x202)]){const _0x2431a0=await window[_0x3055de(0x202)](_0x4bb679);let _0xf5b63d=!0x1;return _0x2431a0['forEach'](_0x49556a=>{const _0xd8353d=_0x3055de,_0x1d24ca=_0x49556a[_0xd8353d(0x207)]?_0x49556a['data']():_0x49556a[_0xd8353d(0x21e)];_0x1d24ca&&(_0x1d24ca[_0xd8353d(0x1e5)]||'')===_0x3587c4&&(_0x1d24ca['date']||'')===_0xc129cd&&(_0xf5b63d=!0x0);}),_0xf5b63d;}throw new Error('No\x20Firestore\x20read\x20APIs\x20exposed\x20on\x20window.');}function shareStudentFromModal(){const _0xd245d5=_0x351b;if(!currentModalStudent)return void alert(_0xd245d5(0x22a));if(!currentModalAttendanceData)return void alert(_0xd245d5(0x1f5));const _0x58ce41=_0x543c49=>{const _0x80a810=_0xd245d5;if(!_0x543c49)return'';const [_0x5c474e,_0x252fd7,_0x3e28db]=_0x543c49[_0x80a810(0x1d7)]('-');return _0x3e28db+'/'+_0x252fd7+'/'+_0x5c474e;},_0x1cf9ce=(currentModalAttendanceData[_0xd245d5(0x1e2)]||currentMonthRangeISO()[_0xd245d5(0x1bd)])[_0xd245d5(0x1d7)]('-'),_0x531bcc=Number(_0x1cf9ce[0x1])-0x1,_0x5ef0cd=_0x1cf9ce[0x0],_0x596bc2=_0xd245d5(0x1a4)+([_0xd245d5(0x222),'February',_0xd245d5(0x1f1),_0xd245d5(0x1c1),'May',_0xd245d5(0x1de),_0xd245d5(0x1c6),_0xd245d5(0x1fd),_0xd245d5(0x205),_0xd245d5(0x215),'November',_0xd245d5(0x1db)][_0x531bcc]||'')+'\x20'+_0x5ef0cd,_0x1d11ec=_0xd245d5(0x1f7)+currentModalStudent,_0x4f3d9c=_0xd245d5(0x1ac)+escapeHtml(currentClass||''),_0x471d7f=_0xd245d5(0x1ba)+_0x58ce41(currentModalAttendanceData[_0xd245d5(0x1e2)])+_0xd245d5(0x21f)+_0x58ce41(currentModalAttendanceData[_0xd245d5(0x1bf)]),_0x57590f=currentModalAttendanceData[_0xd245d5(0x1cf)]>0x0?'Attendance:\x20'+currentModalAttendanceData['attendancePercent']+_0xd245d5(0x1b9)+currentModalAttendanceData[_0xd245d5(0x1ee)]+'/'+currentModalAttendanceData['totalRecords']+_0xd245d5(0x1f0):_0xd245d5(0x210),_0x4a7d02=currentModalAttendanceData[_0xd245d5(0x203)]&&currentModalAttendanceData['absentDays']['length']?_0xd245d5(0x216)+currentModalAttendanceData[_0xd245d5(0x203)][_0xd245d5(0x1af)](',\x20'):'Absent\x20on:\x20—',_0x4d2dab=_0xd245d5(0x1c3)+(currentModalAttendanceData[_0xd245d5(0x20f)]||0x0),_0x90264c='https://wa.me/?text='+encodeURIComponent(_0x596bc2+'\x0a\x0a'+_0x1d11ec+'\x0a'+_0x4f3d9c+'\x0a'+_0x471d7f+'\x0a'+_0x57590f+'\x0a'+_0x4a7d02+'\x0a'+_0x4d2dab+'\x0a\x0aIf\x20you\x20have\x20any\x20questions,\x20please\x20contact\x209967772240.');window[_0xd245d5(0x220)](_0x90264c,_0xd245d5(0x1dd));}async function downloadCSV(){const _0x5b677c=_0x351b;try{const _0x233a2c=new Date(),_0x11653e=_0x233a2c[_0x5b677c(0x1ff)](),_0x26f0fd=_0x233a2c['getMonth'](),_0x139866=new Date(_0x11653e,_0x26f0fd+0x1,0x0)[_0x5b677c(0x1c0)]();if(_0x233a2c[_0x5b677c(0x1c0)]()!==_0x139866||_0x233a2c[_0x5b677c(0x1d5)]()<0x16)return void alert(_0x5b677c(0x1e7));if(!window['db']||!window[_0x5b677c(0x20b)]||!window[_0x5b677c(0x202)])return void alert(_0x5b677c(0x1cb));const {startISO:_0x5d3a36,endISO:_0x230520}=currentMonthRangeISO(),_0x33e5ef=window[_0x5b677c(0x20b)](window['db'],_0x5b677c(0x1c8));let _0x47f812;if(window[_0x5b677c(0x219)]&&window['where'])try{const _0x321758=window[_0x5b677c(0x219)](_0x33e5ef,window['where'](_0x5b677c(0x1b6),'>=',_0x5d3a36),window[_0x5b677c(0x1eb)](_0x5b677c(0x1b6),'<=',_0x230520));_0x47f812=await window[_0x5b677c(0x202)](_0x321758);}catch(_0x3ddc0d){console['warn'](_0x5b677c(0x20d),_0x3ddc0d),_0x47f812=await window['getDocs'](_0x33e5ef);}else _0x47f812=await window[_0x5b677c(0x202)](_0x33e5ef);const _0x156bff=_0x281540=>{const _0x2e0237=_0x5b677c;if(!_0x281540)return'';if(_0x2e0237(0x1aa)==typeof _0x281540)return _0x281540;if('function'==typeof _0x281540[_0x2e0237(0x22e)])try{return _0x281540[_0x2e0237(0x22e)]()['toISOString']()[_0x2e0237(0x22d)](0x0,0xa);}catch{return'';}return _0x281540 instanceof Date?_0x281540['toISOString']()[_0x2e0237(0x22d)](0x0,0xa):String(_0x281540||'');},_0x46cedc=_0x5d852e=>'function'==typeof _0x5d852e[_0x5b677c(0x207)]?_0x5d852e[_0x5b677c(0x207)]():_0x5d852e[_0x5b677c(0x21e)]||{},_0x13da92=new Map();_0x47f812[_0x5b677c(0x1fe)](_0x13ee01=>{const _0x15bcbc=_0x5b677c,_0x42d754=_0x46cedc(_0x13ee01);if(!_0x42d754)return;const _0x173348=_0x156bff(_0x42d754['date']);if(!_0x173348)return;if(_0x173348<_0x5d3a36||_0x173348>_0x230520)return;const _0xd3ca34=(_0x42d754[_0x15bcbc(0x1e6)]||'')[_0x15bcbc(0x1d0)]()[_0x15bcbc(0x1b4)]();if(!_0xd3ca34)return;const _0x1701cb=(_0x42d754[_0x15bcbc(0x1e5)]||'')[_0x15bcbc(0x1d0)]()['trim'](),_0x2157b8=_0xd3ca34+'||'+_0x1701cb;let _0x5f40d2=_0x13da92[_0x15bcbc(0x1c4)](_0x2157b8);_0x5f40d2||(_0x5f40d2={'name':_0xd3ca34,'className':_0x1701cb,'presentCount':0x0,'absentCount':0x0,'lateCount':0x0,'absentDaysSet':new Set()},_0x13da92['set'](_0x2157b8,_0x5f40d2));const _0x585dde=(_0x42d754[_0x15bcbc(0x1be)]||'')['toString']();if('Present'===_0x585dde)_0x5f40d2[_0x15bcbc(0x1ee)]++;else{if(_0x15bcbc(0x218)===_0x585dde){_0x5f40d2[_0x15bcbc(0x21a)]++;const _0x3d3058=_0x173348['split']('-');if(0x3===_0x3d3058[_0x15bcbc(0x1a6)]){const _0x586d33=Number(_0x3d3058[0x2]);Number[_0x15bcbc(0x22c)](_0x586d33)&&_0x5f40d2['absentDaysSet']['add'](_0x586d33);}}}const _0x55e539=(_0x42d754[_0x15bcbc(0x1fb)]||'')[_0x15bcbc(0x1d0)]();(!!_0x42d754[_0x15bcbc(0x1dc)]||_0x15bcbc(0x225)===_0x55e539||_0x15bcbc(0x225)===_0x585dde)&&_0x5f40d2[_0x15bcbc(0x20f)]++;});const _0x46b780=_0x1b9638=>{const _0x1f0b29=_0x5b677c;if(null==_0x1b9638)return'';return'\x22'+String(_0x1b9638)[_0x1f0b29(0x1e9)](/"/g,'\x22\x22')+'\x22';},_0x17b14a=[_0x5b677c(0x1ec),_0x5b677c(0x224),_0x5b677c(0x229),_0x5b677c(0x20c),'9icse',_0x5b677c(0x21c),_0x5b677c(0x1bb),_0x5b677c(0x1df),'10ssc'],_0x4fb420=Array[_0x5b677c(0x1e8)](_0x13da92['values']());_0x4fb420[_0x5b677c(0x1d8)]((_0x1f1710,_0x8e925e)=>{const _0x2748a5=_0x5b677c,_0x3d5e9d=_0x17b14a['indexOf'](_0x1f1710['className'][_0x2748a5(0x214)]()),_0x1c01f9=_0x17b14a[_0x2748a5(0x1b5)](_0x8e925e['className'][_0x2748a5(0x214)]());return-0x1===_0x3d5e9d&&-0x1===_0x1c01f9?_0x1f1710[_0x2748a5(0x1e5)]['localeCompare'](_0x8e925e['className']):-0x1===_0x3d5e9d?0x1:-0x1===_0x1c01f9?-0x1:_0x3d5e9d!==_0x1c01f9?_0x3d5e9d-_0x1c01f9:_0x1f1710[_0x2748a5(0x1e6)][_0x2748a5(0x204)](_0x8e925e[_0x2748a5(0x1e6)]);});const _0x4a4d59=[];_0x4a4d59[_0x5b677c(0x1f8)](['Name','Class','Absent\x20On',_0x5b677c(0x20e),'Attendance\x20%']['join'](','));for(const _0x51c8d6 of _0x4fb420){const _0x13c4bc=_0x51c8d6[_0x5b677c(0x1ee)]||0x0,_0x5c6996=_0x13c4bc+(_0x51c8d6[_0x5b677c(0x21a)]||0x0),_0x2fd81a=_0x5c6996?Math[_0x5b677c(0x1d3)](_0x13c4bc/_0x5c6996*0x64):'No\x20records',_0x58a61b=Array[_0x5b677c(0x1e8)](_0x51c8d6[_0x5b677c(0x1fc)])[_0x5b677c(0x1d8)]((_0x361758,_0x61e14a)=>_0x361758-_0x61e14a),_0x2c7ab9=_0x58a61b[_0x5b677c(0x1a6)]?_0x58a61b[_0x5b677c(0x1af)](',\x20'):'-';_0x4a4d59[_0x5b677c(0x1f8)]([_0x46b780(_0x51c8d6['name']),_0x46b780(_0x51c8d6[_0x5b677c(0x1e5)]||'-'),_0x46b780(_0x2c7ab9),_0x46b780(_0x51c8d6[_0x5b677c(0x20f)]),_0x46b780(_0x2fd81a)][_0x5b677c(0x1af)](','));}if(_0x4a4d59['length']<=0x1)return void alert(_0x5b677c(0x1e3));const _0x1f8207='\ufeff'+_0x4a4d59[_0x5b677c(0x1af)]('\x0d\x0a'),_0x45cbd1=new Blob([_0x1f8207],{'type':_0x5b677c(0x1b1)}),_0xb2a67b=URL[_0x5b677c(0x1b3)](_0x45cbd1),_0xdfe168=_0x229065=>String(_0x229065)['padStart'](0x2,'0'),_0x588f13=_0x5b677c(0x1ca)+_0x11653e+'-'+_0xdfe168(_0x26f0fd+0x1)+'-'+_0xdfe168(_0x139866)+_0x5b677c(0x1f3),_0x39a623=document['createElement']('a');_0x39a623[_0x5b677c(0x221)]=_0xb2a67b,_0x39a623[_0x5b677c(0x1c9)]=_0x588f13,document[_0x5b677c(0x1b0)][_0x5b677c(0x22f)](_0x39a623),_0x39a623['click'](),_0x39a623['remove'](),URL[_0x5b677c(0x1c5)](_0xb2a67b),alert(_0x5b677c(0x1ad));}catch(_0x217ef8){console['error']('downloadCSV\x20failed:',_0x217ef8),alert(_0x5b677c(0x1e4));}}window[_0x3343b(0x1cc)](_0x3343b(0x1a7),loadStudentData);
