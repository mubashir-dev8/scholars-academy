<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <title>Scholars Academy - Attendance & Test Marks</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script type="module" src="firebase.js">
  </script>

</head>

<body>
  <nav>
    <button class="nav-btn active" onclick="showSection('attendanceSection', this)">üìò Attendance</button>
    <button class="nav-btn" onclick="showSection('marksSection', this)">üìù Test Marks</button>
    <!-- New analytics nav -->
    <button class="nav-btn" onclick="showSection('analyticsSection', this)">üìä Students Analytics</button>
  </nav>

  <!-- ===== LOGIN VALIDATION MODAL (appears on page load) ===== -->
  <div id="authOverlay" class="auth-overlay" aria-hidden="false">
    <div class="auth-modal" role="dialog" aria-modal="true" aria-labelledby="authTitle">
      <h2 id="authTitle">Teacher Sign In</h2>
      <p>Please enter your name and passcode to continue</p>
      <input id="teacherNameInput" type="text" placeholder="Username" autocomplete="off" />
      <input id="teacherPassInput" type="password" placeholder="Passcode" autocomplete="off" />
      <button id="authSignBtn">Sign In</button>
      <div class="auth-hint">Contact Mubashir if you don't have credentials.</div>
    </div>
  </div>
  <!-- ======================================================= -->

  <div class="container">
    <!-- Attendance Section -->
    <div id="attendanceSection" class="section active">
      <div class="logo-wrap">
        <img src="logo.jpg" alt="Scholars Academy logo" class="class-logo" loading="lazy"
          onerror="this.style.display='none'" width="100%" height="10%">
      </div>
      <div class="class-buttons" id="classButtons">
        <h2 style="width:100%; text-align:center; margin:0 0 8px 0; font-size:16px;">Select Class</h2>
        <button onclick="loadClass('5th ICSE')">5th ICSE</button>
        <button onclick="loadClass('6th ICSE')">6th ICSE</button>
        <button onclick="loadClass('7th ICSE')">7th ICSE</button>
        <button onclick="loadClass('8th ICSE')">8th ICSE</button>
        <button onclick="loadClass('9th ICSE')">9th ICSE</button>
        <button onclick="loadClass('10th ICSE')">10th ICSE</button>
        <button onclick="loadClass('9th Symbiosis')">9th SYM</button>
        <button onclick="loadClass('9th General')">9th GEN</button>
        <button onclick="loadClass('10th SSC')">10th SSC</button>
      </div>
      <div class="students-list" id="studentsList"></div>
      <div class="summary-section">
        <button onclick="generateResult()">Get Result</button>
        <button onclick="clearResult()">Clear Summary</button>
        <!-- NEW: Submit Attendance button -->
        <button id="submitAttendanceBtn" onclick="submitAttendance()">Submit Attendance</button>

        <textarea id="summary" placeholder="Absent and present students will appear here..." readonly></textarea>
        <button id="shareBtn" onclick="shareOnWhatsApp()">Share on WhatsApp</button>
        <button id="downloadImageBtn" onclick="downloadAttendanceImage()">Download Image</button>
      </div>
    </div>

    <!-- Test Marks Section -->
    <div id="marksSection" class="section">
      <div class="logo-wrap">
        <img src="logo.jpg" alt="Scholars Academy logo" class="class-logo" loading="lazy"
          onerror="this.style.display='none'" width="100%" height="10%">
      </div>
      <h1>Test Marks</h1>
      <div class="class-buttons" style="margin-bottom:6px;">
        <h2 style="width:100%; text-align:center; margin:0 0 8px 0; font-size:16px;">Select Class</h2>
        <button onclick="loadClass('5th ICSE')">5th ICSE</button>
        <button onclick="loadClass('6th ICSE')">6th ICSE</button>
        <button onclick="loadClass('7th ICSE')">7th ICSE</button>
        <button onclick="loadClass('8th ICSE')">8th ICSE</button>
        <button onclick="loadClass('9th ICSE')">9th ICSE</button>
        <button onclick="loadClass('10th ICSE')">10th ICSE</button>
        <button onclick="loadClass('9th Symbiosis')">9th SYM</button>
        <button onclick="loadClass('9th General')">9th GEN</button>
        <button onclick="loadClass('10th SSC')">10thSSC</button>
      </div>
      <div class="marks-meta" style="max-width:960px; margin:0 auto 6px;">
        <input id="subjectInput" placeholder="Subject name (e.g. Physics)" />
        <input id="chapterInput" placeholder="Chapter (e.g. Chapter 3: Laws)" />
        <input id="totalMarksInput" placeholder="Total Marks (e.g. 20)" type="number" min="1"
          oninput="onTotalMarksChange()" />
      </div>
      <div class="students-list" id="marksStudentsList" style="max-width:960px; margin: 10px auto;"></div>
      <div class="summary-section">
        <button onclick="generateMarksResult()">Generate Marks</button>
        <button onclick="clearMarksResult()">Clear Summary</button>
        <textarea id="marksSummary" placeholder="Students' marks will appear here..." readonly></textarea>
        <button id="shareMarksBtn" onclick="shareMarksOnWhatsApp()">Share on WhatsApp</button>
      </div>
    </div>

    <!-- NEW: Students Analytics Section -->
    <div id="analyticsSection" class="section">
      <div class="logo-wrap">
        <img src="logo.jpg" alt="Scholars Academy logo" class="class-logo" loading="lazy"
          onerror="this.style.display='none'" width="100%" height="10%">
      </div>
      <h1>Analytics - WORK IN PROGRESS....!!!!</h1>
      <div class="class-buttons" style="margin-bottom:6px;">
        <h2 style="width:100%; text-align:center; margin:0 0 8px 0; font-size:16px;">Select Class</h2>
        <button onclick="loadClass('5th ICSE')">5th ICSE</button>
        <button onclick="loadClass('6th ICSE')">6th ICSE</button>
        <button onclick="loadClass('7th ICSE')">7th ICSE</button>
        <button onclick="loadClass('8th ICSE')">8th ICSE</button>
        <button onclick="loadClass('9th ICSE')">9th ICSE</button>
        <button onclick="loadClass('10th ICSE')">10th ICSE</button>
        <button onclick="loadClass('9th Symbiosis')">9th SYM</button>
        <button onclick="loadClass('9th General')">9th GEN</button>
        <button onclick="loadClass('10th SSC')">10thSSC</button>
      </div>

      <div class="students-list" id="analyticsStudentsList" style="max-width:960px; margin: 10px auto;"></div>
      <div style="max-width:960px;margin:12px auto;color:#666;font-size:14px;">
        Note: Attendance % shown here is a temporary/session-only estimate. I'll wire it to DB later.
      </div>
    </div>
  </div>

  <!-- Student details modal (analytics) -->
  <div id="studentDetailsModal" class="student-modal-overlay" role="dialog" aria-modal="true"
    aria-labelledby="studentDetailsTitle">
    <div class="student-modal" role="document">
      <h3 id="studentDetailsTitle">Student Details</h3>
      <div id="studentDetailsContent">
        <!-- Filled by JS -->
      </div>
      <button class="close-btn" onclick="hideStudentDetailsModal()">Close</button>
    </div>
  </div>

  <!-- NOTE: script.js is loaded as a module so it can import Firebase -->
  <!-- <script type="module" src="firebase.js"></script> -->
  <script src="script.js"></script>

  <footer>¬© 2025 Developed By Mubashir. All rights reserved.</footer>
</body>

</html>
